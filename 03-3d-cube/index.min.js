var e=a.height,r=a.width,t=0,m=Math.sin,o=Math.cos,p=Math.random,s=128;for(M=((i,a)=>i.map(i=>a[0].map((i,e)=>a.map(i=>i[e])).map(a=>i.map((e,r)=>i[r]*a[r]).reduce((i,a)=>i+a)))),dt=((i,a)=>i.reduce((i,e,r)=>i+(e-a[r])**2,0)),O=[],i=100;i--;)O.push([p()*r,p()*e,3*p(),p()-.5,p()-.5,p()/50]);for(P=[],i=8;i--;)P.push([i%2,i%4<2?0:1,i%8<4?0:1].map(i=>2*i-1));(L=(()=>{var a=(i,a)=>{var e=M([[o(a),0,-m(a)],[0,1],[m(a),0,o(a)]],M([[o(a/4),-m(a/4)],[m(a/4),o(a/4)],[0,0,1]],i.map(i=>[i])));return M([[1],[0,1]],e).map(i=>i[0]*r/40)};c.lineWidth=2,c.strokeStyle="rgba(0,0,0,0.1)",O.map(e=>{for(c.setTransform(1,0,0,1,e[0],e[1]),c.fillStyle=`rgb(${m(2*e[2])*s+s},${o(e[2])*s+s},${m(e[2])*s+s},0.5)`,i=6;i--;)c.beginPath(),P.sort(a=>a[i/2]).slice(i%2*4,4+i%2*4).map((i,r)=>(i=a(i,e[2]),r?c.lineTo(i[0],i[1]):c.moveTo(i[0],i[1]))),c.closePath(),c.fill(),c.stroke(),i<3&&(e[i]+=e[i+3])}),requestAnimationFrame(L)}))();
